
extends ../layout

block content
	.page-header
		h1
			| My Account
			small this is you
	.row
		.span3
			.well
				h6 Picture
				img(src='https://graph.facebook.com/' + everyauth.user.fb.id + '/picture?type=large', alt='#{user.fullName}')
			.well
				h6 Info
				strong name
				p(data-bind='text: fullName')
				strong status
				p(data-bind='text: status')
				strong email
				p
					a(data-bind='text: email, attr: { href: email() }')
				strong gender
				p= me.fb.gender
				strong facebook
				p
					a(href='#{everyauth.facebook.user.link}', target='_blank') #{everyauth.facebook.user.username}
				strong twitter
				p(data-bind='text: twitter')
				strong bio
				p(data-bind='text: bio')

			- if (!me.group)
				.alert
					button.close(data-dismiss='alert') ×
					span In order to use all features, you'll have to join or create a group!
				.well
					a.btn.btn-primary.btn-large(data-toggle='modal', href='#create_group_modal') Create a group
					#create_group_modal.modal.hide.fade
						.modal-header
								button.close(data-dismiss='modal') ×
								h3 New Group
							.modal-body
								form#new_group_form(method='post', action='/groups')
									.control-group
										label.control-label(for='group_name') Name
											.controls
												input#group_name.input-xlarge(type='text', name='name', placeholder='Your groups cool name goes here')
									.control-group
										label.control-label(for='group_description') Description
											.controls
												textarea#group_description.input-xlarge(rows='3', name='description', placeholder='Some awesome group description')
							.modal-footer
								button.btn.btn-primary(type='submit', form='new_group_form') Create
			- else
				.well
					a.btn.btn-primary.pull-right(href='/groups/#{me.group._id}') View
					h6 Group
					strong name
					p= me.group.name
					strong description
					p= me.group.description

		.span8.offset1
			#update-success.alert.alert-success.fade.in(style='display: none;')
				button.close(data-dismiss='alert')×
				strong Success!&nbsp;
				| Profile updated ;)
			form.form-horizontal
				fieldset
					legend Edit my profile
					.control-group
						label.control-label(for='name') Full name:
						.controls
							input(type='text', name='name', data-bind='value: fullName')
					.control-group
						label.control-label(for='email') Email:
						.controls
							input(type='email', name='email', data-bind='value: email')
					.control-group
						label.control-label(for='bio') Bio:
						.controls
							textarea(name='bio', placeholder='Something about you.', data-bind='value: bio')
					.control-group
						label.control-label(for='status') Status:
						.controls
							select(name='status', data-bind='options: statusValues, value: status')
					.control-group
						label.control-label(for='twitter') Twitter:
						.controls
							.input-prepend
								span.add-on @
								input#prependedInput(type='text', name='twitter', data-bind='value: twitter')
					.form-actions
						btn#update_profile.btn.btn-primary.btn-large(data-bind='click: update') Update Profile

append scripts
	script
		var userId = !{JSON.stringify(me._id)};
	script(src='/js/profile.knockout.js')
